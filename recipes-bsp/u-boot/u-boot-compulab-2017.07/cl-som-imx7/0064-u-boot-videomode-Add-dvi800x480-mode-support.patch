From 6dde9b71d778af8b3a7201ddfaff89cb3556bc9c Mon Sep 17 00:00:00 2001
From: Valentin Raevsky <valentin@compulab.co.il>
Date: Thu, 8 Apr 2021 15:55:04 +0300
Subject: [PATCH] u-boot: videomode: Add dvi800x480 mode support

Signed-off-by: Valentin Raevsky <valentin@compulab.co.il>
---
 board/compulab/cl-som-imx7/display.c | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

diff --git a/board/compulab/cl-som-imx7/display.c b/board/compulab/cl-som-imx7/display.c
index 9e42502341..b0b26930ff 100644
--- a/board/compulab/cl-som-imx7/display.c
+++ b/board/compulab/cl-som-imx7/display.c
@@ -53,6 +53,7 @@ typedef enum {
 	PRSET_DVI_1024X768,
 	PRSET_DVI_1280X1024,
 	PRSET_DVI_1920x1080,
+	PRSET_DVI_800X480,
 	PRSET_NONE,
 } display_preset;
 
@@ -138,6 +139,21 @@ static struct disp_param dispparams[] = {
 			.vsync_len      = 6,
 		}
 	},
+	{/* PRSET_DVI_800X480 */
+		.del_node = FDT_NODE_REG_LCD,
+		.timings = {
+			.refresh	= 29580000,
+			.pixclock	= 29500,
+			.xres		= 800,
+			.left_margin	= 1,
+			.right_margin	= 16,
+			.hsync_len	= 80,
+			.yres		= 480,
+			.upper_margin	= 13,
+			.lower_margin	= 16,
+			.vsync_len	= 16,
+		}
+	},
 };
 
 /* Selected display preset ID */
@@ -385,6 +401,8 @@ static display_type env_parse_displaytype(char *disp_type)
 		selected_preset = PRSET_DVI_1280x720;
 	else if (!strcmp(disp_type, "lcd_KD050C"))
 		selected_preset = PRSET_LCD_KD050C;
+	else if (!strcmp(disp_type, "dvi_800x480"))
+		selected_preset = PRSET_DVI_800X480;
 	return set_preset();
 }
 
-- 
2.11.0

